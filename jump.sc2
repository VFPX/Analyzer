*--------------------------------------------------------------------------------------------------------------------------------------------------------
* (ES) AUTOGENERADO - ¡¡ATENCIÓN!! - ¡¡NO PENSADO PARA EJECUTAR!! USAR SOLAMENTE PARA INTEGRAR CAMBIOS Y ALMACENAR CON HERRAMIENTAS SCM!!
* (EN) AUTOGENERATED - ATTENTION!! - NOT INTENDED FOR EXECUTION!! USE ONLY FOR MERGING CHANGES AND STORING WITH SCM TOOLS!!
*--------------------------------------------------------------------------------------------------------------------------------------------------------
*< FOXBIN2PRG: Version="1.19" SourceFile="jump.scx" /> (Solo para binarios VFP 9 / Only for VFP 9 binaries)
*
*
DEFINE CLASS dataenvironment AS dataenvironment 
 	*< CLASSDATA: Baseclass="dataenvironment" Timestamp="" Scale="" Uniqueid="" ClassIcon="1" />

	Height = 200
	Left = 1
	Name = "Dataenvironment"
	Top = 220
	Width = 520

ENDDEFINE

DEFINE CLASS form1 AS form 
 	*< CLASSDATA: Baseclass="form" Timestamp="" Scale="" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="pageframe1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe1.page1.list1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe1.page1.cmdGoto" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe1.page1.cmdNext" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe1.page1.grid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe1.page1.grid1.column1.header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe1.page1.grid1.column1.text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe1.page1.grid1.column2.header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe1.page1.grid1.column2.text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe1.page1.grid1.column3.header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe1.page1.grid1.column3.text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe1.page1.grid1.column4.header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe1.page1.grid1.column4.text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe1.page1.Label1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe1.page2.opt" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pageframe1.page2.ol" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Command1" UniqueID="" Timestamp="" />

	AutoCenter = .T.
	BorderStyle = 1
	Caption = "Code Analyzer"
	DataSession = 1
	DoCreate = .T.
	ForeColor = 0,0,0
	Height = 380
	HelpContextID = 22990009
	MaxButton = .F.
	Name = "form1"
	ScaleMode = 3
	Width = 607

	ADD OBJECT 'Command1' AS commandbutton WITH ;
		Cancel = .T., ;
		Caption = "\<Close", ;
		FontName = "Tahoma", ;
		Height = 23, ;
		Left = 432, ;
		Name = "Command1", ;
		TabIndex = 6, ;
		Top = 96, ;
		Width = 72
		*< END OBJECT: BaseClass="commandbutton" />

	ADD OBJECT 'pageframe1' AS pageframe WITH ;
		ErasePage = .T., ;
		Height = 378, ;
		Left = 0, ;
		Name = "pageframe1", ;
		PageCount = 2, ;
		TabStyle = 1, ;
		Top = 2, ;
		Width = 607, ;
		Page1.Caption = "\<Symbols", ;
		Page1.FontName = "Tahoma", ;
		Page1.Name = "page1", ;
		Page2.Caption = "\<Hierarchies", ;
		Page2.FontName = "Tahoma", ;
		Page2.Name = "page2"
		*< END OBJECT: BaseClass="pageframe" />

	ADD OBJECT 'pageframe1.page1.cmdGoto' AS commandbutton WITH ;
		Caption = "\<Goto", ;
		FontName = "Tahoma", ;
		Height = 23, ;
		Left = 431, ;
		Name = "cmdGoto", ;
		TabIndex = 4, ;
		Top = 20, ;
		Width = 72
		*< END OBJECT: BaseClass="commandbutton" />

	ADD OBJECT 'pageframe1.page1.cmdNext' AS commandbutton WITH ;
		Caption = "\<Next", ;
		FontName = "Tahoma", ;
		Height = 23, ;
		Left = 431, ;
		Name = "cmdNext", ;
		TabIndex = 5, ;
		Top = 44, ;
		Width = 72
		*< END OBJECT: BaseClass="commandbutton" />

	ADD OBJECT 'pageframe1.page1.grid1' AS grid WITH ;
		ChildOrder = "symbol", ;
		ColumnCount = 4, ;
		DeleteMark = .F., ;
		FontName = "Tahoma", ;
		Height = 181, ;
		Left = 2, ;
		LinkMaster = "symbols", ;
		Name = "grid1", ;
		Panel = 1, ;
		ReadOnly = .T., ;
		RecordSource = "fdxref", ;
		RelationalExpr = "upper(symbol)", ;
		TabIndex = 3, ;
		Top = 161, ;
		Width = 598, ;
		Column1.ControlSource = "fdxref.procname", ;
		Column1.FontName = "Tahoma", ;
		Column1.Name = "column1", ;
		Column1.ReadOnly = .T., ;
		Column1.Width = 175, ;
		Column2.ControlSource = "fdxref.lineno", ;
		Column2.FontName = "Tahoma", ;
		Column2.Name = "column2", ;
		Column2.ReadOnly = .T., ;
		Column2.Width = 38, ;
		Column3.ControlSource = "fdxref.filename", ;
		Column3.FontName = "Tahoma", ;
		Column3.FontSize = 9, ;
		Column3.Name = "column3", ;
		Column3.ReadOnly = .T., ;
		Column3.Width = 310, ;
		Column4.ControlSource = "fdxref.flag", ;
		Column4.FontName = "Tahoma", ;
		Column4.Name = "column4", ;
		Column4.ReadOnly = .T., ;
		Column4.Width = 34
		*< END OBJECT: BaseClass="grid" />

	ADD OBJECT 'pageframe1.page1.grid1.column1.header1' AS header WITH ;
		Caption = "Procedure Name", ;
		FontName = "Tahoma", ;
		Name = "header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'pageframe1.page1.grid1.column1.text1' AS textbox WITH ;
		BorderStyle = 0, ;
		FontName = "Tahoma", ;
		Name = "text1", ;
		ReadOnly = .T.
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'pageframe1.page1.grid1.column2.header1' AS header WITH ;
		Caption = "Line", ;
		FontName = "Tahoma", ;
		Name = "header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'pageframe1.page1.grid1.column2.text1' AS textbox WITH ;
		BorderStyle = 0, ;
		FontName = "Tahoma", ;
		Name = "text1", ;
		ReadOnly = .T.
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'pageframe1.page1.grid1.column3.header1' AS header WITH ;
		Caption = "File Name", ;
		FontName = "Tahoma", ;
		Name = "header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'pageframe1.page1.grid1.column3.text1' AS textbox WITH ;
		BorderStyle = 0, ;
		FontName = "Tahoma", ;
		FontSize = 9, ;
		Name = "text1", ;
		ReadOnly = .T.
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'pageframe1.page1.grid1.column4.header1' AS header WITH ;
		Caption = "Flag", ;
		FontName = "Tahoma", ;
		Name = "header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'pageframe1.page1.grid1.column4.text1' AS textbox WITH ;
		BorderStyle = 0, ;
		FontName = "Tahoma", ;
		Name = "text1", ;
		ReadOnly = .T.
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'pageframe1.page1.Label1' AS label WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "Click on a Procedure Name to View Source:", ;
		FontName = "Tahoma", ;
		Height = 16, ;
		Left = 14, ;
		Name = "Label1", ;
		TabIndex = 2, ;
		Top = 146, ;
		Width = 241
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'pageframe1.page1.list1' AS listbox WITH ;
		ColumnCount = 2, ;
		ColumnWidths = "230,50", ;
		FontName = "Tahoma", ;
		FontSize = 9, ;
		Height = 133, ;
		IntegralHeight = .T., ;
		Left = 16, ;
		Name = "list1", ;
		NumberOfElements = 0, ;
		RowSource = "LEFT(symbol,30),str(count,5)", ;
		RowSourceType = 2, ;
		TabIndex = 1, ;
		Top = 6, ;
		Width = 313
		*< END OBJECT: BaseClass="listbox" />

	ADD OBJECT 'pageframe1.page2.ol' AS olecontrol WITH ;
		Height = 296, ;
		Left = 26, ;
		Name = "ol", ;
		Top = 12, ;
		Width = 357
		*< END OBJECT: BaseClass="olecontrol" OLEObject="c:\winnt\system32\mscomctl.ocx" Value="0M8R4KGxGuEAAAAAAAAAAAAAAAAAAAAAPgADAP7/CQAGAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAEAAAAgAAAAEAAAD+////AAAAAAAAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9/////v////7///8EAAAA/v///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////1IAbwBvAHQAIABFAG4AdAByAHkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWAAUA//////////8BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJA1pN33ScABAwAAAEACAAAAAAAAAwBPAGwAZQBPAGIAagBlAGMAdABEAGEAdABhAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4AAgEDAAAAAgAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAagAAAAAAAAADAEEAYwBjAGUAcwBzAE8AYgBqAFMAaQB0AGUARABhAHQAYQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJgACAP///////////////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAABcAAAAAAAAAAMAQwBoAGEAbgBnAGUAZABQAHIAbwBwAHMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAIA////////////////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAkBAAAAAAAABAAAAAIAAAD+////BQAAAP7///8GAAAABwAAAAgAAAD+//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////+2kEHHiYXREbFqAMDwKDYoIUM0EggAAADmJAAAmB4AALE8wWoBAAYAIgAAALkAAADtAwAACAAAANmDFgAB782rXAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAACQAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA5MzY4MjY1RS04NUZFLTExZDEtOEJFMy0wMDAwRjg3NTREQTF2d3dwDMzMzAMAAAC3AREAzMzMzAzMzMwQAAAAEAAAAKcBAAABAACADgAAAEhpZGVTZWxlY3Rpb24ABQAAAEwBAAAADAAAAEluZGVudGF0aW9uABEAAABODQAAAAcAAAAAAAAAAAAFAKiFFgAGAAAAAAAAAAUAAIBw6RIAAQAAAFwAH97svQEABQB46RIAJgEAAQwAiL6ed2i+nndIvp53ML6edwAAQ0AKAAAATGFiZWxFZGl0AAkAAABJCgAAAAEAAAAKAAAATGluZVN0eWxlAAkAAABJCgAAAAEAAAANAAAATW91c2VQb2ludGVyAAkAAABJCgAAAAAAAAAOAAAAUGF0aFNlcGFyYXRvcgAKAAAASAAAAAABAAAAXAYAAABTdHlsZQAJAAAASQoAAAAGAAAADAAAAE9MRURyYWdNb2RlAAkAAABJCgAAAAAAAAAMAAAAT0xFRHJvcE1vZGUACQAAAEkKAAAAAAAAAAITAKgCEwAzAAAAFAAAAP////8GAAAAAwAAACUAAAAGAAAACQAAAAAAAAAAAAAAAAAAAAAAAAA4AgwAAAAAAAUACQAAAQgAAOMWAHDjFgDQ4xYAAAAAAAAAAAAAAAAAAAAAAAAAAAAYAA4AAAAIADgCEwA4AhMAXQAAABQAAAD/////BgAAAAMAAAAVAAAABgAAAAkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAkAAAAOAJABEwCoXhgAAADVANYA1wAJAAwAAAEIAF0AAAACAAAAigAAABQAAAD/////BgAAAAMAAAAhAAAABgAAAAkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADABUAAAAIAJABEwCoXhgAdQByAGUAAAAGAEAAAAEMAKTroHcAAAAACAAAABAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAHAAYAAIAUYAAAAIAAiAGADYAxgAgABwAIAAgABwAHAAgABwALAAcABwAHAAAwAFAAAACgBgXhgAkAETAGUAPgAAADAAIQAIAAABCAA8AE4AbwBuAGUAPgAAADAAMAAwADAAMAAwADAAMAAwADAAMABQAHAAYACAAGAAIAAwADAAQABgADAAMAAwAFAAYABgAGAAYABgAGAAYABgAGAAYAAwADAA" />

	ADD OBJECT 'pageframe1.page2.opt' AS optiongroup WITH ;
		BackStyle = 0, ;
		ButtonCount = 2, ;
		Height = 48, ;
		Left = 431, ;
		Name = "opt", ;
		Top = 12, ;
		Value = 0, ;
		Width = 125, ;
		Option1.BackStyle = 0, ;
		Option1.Caption = "Calling \<Tree", ;
		Option1.Height = 18, ;
		Option1.Left = 5, ;
		Option1.Name = "option1", ;
		Option1.Top = 5, ;
		Option1.Value = 0, ;
		Option1.Width = 104, ;
		Option2.BackStyle = 0, ;
		Option2.Caption = "Class \<Diagram", ;
		Option2.Height = 18, ;
		Option2.Left = 5, ;
		Option2.Name = "option2", ;
		Option2.Top = 25, ;
		Option2.Value = 0, ;
		Option2.Width = 104
		*< END OBJECT: BaseClass="optiongroup" />
	
	PROCEDURE Destroy
		pop menu _msysmenu
		IF USED("files")
			USE IN files
		ENDIF
		IF USED("symbols")
			USE IN symbols
		ENDIF
		IF USED("fdxref")
			USE IN fdxref
		ENDIF
		IF USED("snipfile")
			USE IN snipfile
		ENDIF
		
	ENDPROC

	PROCEDURE Init
		PUBLIC m.symbol
		push menu _msysmenu
		
		DO jump.mpr
			m.symbol=""
		this.pageframe1.page1.list1.selected(1)=.t.
		
		*- Set the radio button on the Hierarchy page
		THIS.Pageframe1.Page2.opt.Value = 1
		
	ENDPROC

	PROCEDURE Load
		set exact off
		set conf on
		CLOSE DATA
		
		IF !USED("fdxref")
			use (mdir+"fdxref") again excl
		ENDIF
		select fdxref
		set order to symbol
		IF !USED("symbols")
			SELECT upper(symbol) as symbol,count(*) as count ;
				FROM fdxref INTO CURSOR symbols order by 1 group by 1
		ENDIF
		SELECT symbols
		LOCATE
		this.caption=this.caption+' - '+mdir
		
	ENDPROC

	PROCEDURE Command1.Click
		thisform.release
	ENDPROC

	PROCEDURE pageframe1.page1.Activate
		set order to symbol in fdxref
		SELECT symbols
		
	ENDPROC

	PROCEDURE pageframe1.page1.cmdGoto.Click
		DO tex  in analyzer with 'G'
		select symbols
		
	ENDPROC

	PROCEDURE pageframe1.page1.cmdNext.Click
		DO tex  in analyzer with 'N'
		select symbols
		
	ENDPROC

	PROCEDURE pageframe1.page1.grid1.column1.text1.Click
		DO tex  in analyzer with 'G'
	ENDPROC

	PROCEDURE pageframe1.page1.list1.GotFocus
		select symbols
		
	ENDPROC

	PROCEDURE pageframe1.page2.ol.DblClick
		*** ActiveX Control Event ***
		#DEFINE RECURSION_LOC	 " (recursion)"
		
		LOCAL loNode
		loNode = THIS.SelectedItem
		
		*- click nothing if no children
		*- dblclick opens code
		IF thisform.pageframe1.page2.opt.value = 1
			SELECT fdxref
			SET ORDER TO symbol
			SEEK UPPER(STRTRAN(loNode.Text,RECURSION_LOC,""))
			do tex in analyzer  with 'G'
		ENDIF
		
		
	ENDPROC

	PROCEDURE pageframe1.page2.opt.InteractiveChange
		do tre in analyzer with this.value,this.parent.ol
	ENDPROC

	PROCEDURE pageframe1.page2.opt.ProgrammaticChange
		this.interactiveChange
	ENDPROC

ENDDEFINE
